{% extends "base.html" %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
{% block title %} employeelist {% endblock %}
    </title>
{% block content %}
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.4.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/employeelist.css') }}">
</head>

<body>

    <div class="page">

        <!-- Breadcrumb -->
        <div class="breadcrumbs">
            Dashboard / Employee Management / <span>Employee List</span>
        </div>

        <div class="header-row">
            <h2>Employee List</h2>
            <div class="btn-group">
            <a class="add-btn" href="{{ url_for('addemployee.addemployee') }}">Add Employee</a>
            <a class="rg-btn" href="{{ url_for('employeelist.generate_id') }}">Generate Id</a>
            </div>
        </div>

        

        <!-- Filters -->
         <form id="filterForm" action="{{ url_for('employeelist.filter_employee')}}" method="POST">
        <div class="filters">
            <div class="input-box">
                <input type="text" name="store_name" id="store_name" placeholder="Store Name" value="{{ store_name or '' }}">
                <i class="ri-search-line"></i>
            </div>

            <div class="input-box">
                <input type="text" name="employee_name" id="employee_name" placeholder="Employee Name" value="{{ employee_name or '' }}">
                <i class="ri-search-line"></i>
            </div>

            <div class="input-box">
                <input name="date" id="date" type="date" value="{{ date or '' }}">
            </div>
            
            <button type="submit" class="filter-btn" style="padding: 0.75rem 1.5rem; background: var(--primary, #005dfa); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                <i class="ri-filter-line"></i> Filter
            </button>
            
            {% if store_name or employee_name or date %}
            <a href="{{ url_for('employeelist.employeelist') }}" class="clear-btn" style="padding: 0.75rem 1.5rem; background: #f5f7fb; color: var(--text-dark, #0f172a); border: 1px solid #e2e8f0; border-radius: 8px; cursor: pointer; font-weight: 600; text-decoration: none; display: inline-block;">
                <i class="ri-close-line"></i> Clear
            </a>
            {% endif %}
        </div>
</form>
        <!-- Table -->
        <div class="table-container">
            <table class="emp-table">
                <thead>
                    <tr>
                        <th><input type="checkbox"></th>
                        <th>ID</th>
                        <th>Store Name</th>
                        <th>Employee Name</th>
                        <th>Email</th>
                        <th>Designation</th>
                        <th>Contact</th>
                        <th>Created At</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for i in employees.items %}
                    <tr>
                        <td> <input type="checkbox"></td>
                        <td>{{ i.id }}</td>
                        <td>{{ i.store.store_name }}</td>
                        <td>{{ i.employee_name }}</td>
                        <td>{{ i.email }}</td>
                        <td>{{ i.designation }}</td>
                        <td>{{ i.contact1 }}</td>
                        <td>{{ i.created_at.strftime('%d-%m-%Y') }}</td>
                        <td>{{ i.status }}</td>
                        <td class="actions">
                            <a href="#" class="edit-btn" data-id="{{ i.id }}" data-tooltip="Edit Employee" title="Edit Employee"><i class="ri-edit-line"></i></a>
                            <a href="{{ url_for('employeelist.delete_employee', id=i.id)}}" class="delete-btn" data-tooltip="Delete Employee" title="Delete Employee" onclick="return confirm('Are you sure you want to delete this employee?');"><i class="ri-delete-bin-line"></i></a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        </div>

        <!-- Pagination -->
        <div class="pagination">
            {% if employees.has_prev %}
            <a href="{{ url_for('employeelist.employeelist', page=employees.prev_num, store_name=store_name, employee_name=employee_name, date=date) }}" class="page-btn">Previous</a>
            {% else %}
            <span class="page-btn disabled">Previous</span>
            {% endif %}

            <span class="page-info">Page {{ employees.page }} of {{ employees.pages }}</span>

            {% if employees.has_next %}
            <a href="{{ url_for('employeelist.employeelist', page=employees.next_num, store_name=store_name, employee_name=employee_name, date=date) }}" class="page-btn">Next</a>
            {% else %}
            <span class="page-btn disabled">Next</span>
            {% endif %}
        </div>

    </div>
<!-- Edit Employee Modal -->
<div class="edit-emp-modal" id="editEmpModal">
    <div class="edit-emp-content animate-emp">

        <div class="emp-modal-header">
            <h2>Edit Employee</h2>
            <button class="emp-close-btn" id="empCloseBtn">&times;</button>
        </div>

        <form id="editEmployeeForm" method="POST" action="{{ url_for('employeelist.update_employee') }}">

            <input type="hidden" name="id" id="emp_id">

            <div class="emp-grid">

                <div class="field-box">
                    <label>Store Name</label>
                    <select name="store_id" id="emp_store">
                        {% for store in stores %}
                        <option value="{{ store.id }}">{{ store.store_name }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="field-box">
                    <label>Employee Name</label>
                    <input type="text" name="employee_name" id="emp_name">
                </div>

                <div class="field-box">
                    <label>Email</label>
                    <input type="email" name="email" id="emp_email">
                </div>

                <div class="field-box">
                    <label>Designation</label>
                    <select name="designation" id="emp_designation">
                        {% for d in ["Manager","Cashier","Stock Handler","Accountant","Delivery Boy"] %}
                        <option value="{{ d }}">{{ d }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="field-box">
                    <label>Status</label>
                    <select name="status" id="emp_status">
                        <option>Active</option>
                        <option>Inactive</option>
                    </select>
                </div>

                <div class="field-box">
                    <label>Address Name</label>
                    <input type="text" name="address_name" id="emp_address_name">
                </div>

                <div class="field-box">
                    <label>Street Name</label>
                    <input type="text" name="street_name" id="emp_street">
                </div>

                <div class="field-box">
                    <label>Town</label>
                    <input type="text" name="town" id="emp_town">
                </div>

                <div class="field-box">
                    <label>Locality</label>
                    <input type="text" name="locality_name" id="emp_locality">
                </div>

                <div class="field-box">
                    <label>Post Code</label>
                    <input type="text" name="post_code" id="emp_post_code">
                </div>

                <div class="field-box">
                    <label>Contact 1</label>
                    <input type="text" name="contact1" id="emp_contact1">
                </div>

                <div class="field-box">
                    <label>Contact 2</label>
                    <input type="text" name="contact2" id="emp_contact2">
                </div>

            </div>

            <div class="emp-footer">
                <button type="button" id="empCancelBtn" class="emp-cancel">Cancel</button>
                <button type="submit" class="emp-save">Save Changes</button>
            </div>

        </form>

    </div>
</div>

</body>
<script src="{{ url_for('static', filename=('js/employeelist.js'))}}"></script>
</html>
{% endblock %}